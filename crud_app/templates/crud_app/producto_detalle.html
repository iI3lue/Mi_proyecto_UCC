{% extends 'crud_app/base.html' %}
{% load static %}
{% load custom_filters %}

{% block title %}{{ producto.nombre }} - TechStore{% endblock %}

{% block contenido %}
<div class="container" style="margin-top: 2rem;">
  <!-- Breadcrumb -->
  <nav style="margin-bottom: 2rem;">
    <a href="{% url 'index' %}" style="color: var(--accent-blue); text-decoration: none;">Inicio</a>
    <span style="color: var(--text-secondary); margin: 0 0.5rem;">‚Üí</span>
    <a href="{% url 'lista_productos' %}" style="color: var(--accent-blue); text-decoration: none;">Productos</a>
    <span style="color: var(--text-secondary); margin: 0 0.5rem;">‚Üí</span>
    <span style="color: var(--text-secondary);">{{ producto.nombre }}</span>
  </nav>
  
  <!-- Detalle del producto -->
  <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 3rem; align-items: start;">
    <!-- Imagen -->
    <div style="position: sticky; top: 100px;">
      <div style="background-color: var(--secondary-bg); border-radius: var(--radius-lg); overflow: hidden; box-shadow: var(--shadow-md);">
        {% if producto.imagen %}
          <img 
            src="{{ producto.imagen.url }}" 
            alt="{{ producto.nombre }}" 
            style="width: 100%; height: auto; display: block;"
          >
        {% else %}
          <img 
            src="https://via.placeholder.com/600x450?text=Sin+Imagen" 
            alt="Sin imagen" 
            style="width: 100%; height: auto; display: block;"
          >
        {% endif %}
      </div>
      
      <!-- Badges de estado -->
      <div style="display: flex; gap: 1rem; margin-top: 1rem;">
        {% if producto.stock > 0 %}
          {% if producto.stock < 5 %}
            <span style="background-color: var(--warning); color: white; padding: 0.5rem 1rem; border-radius: var(--radius-full); font-weight: 600; font-size: 0.9rem;">
              ‚ö†Ô∏è Solo {{ producto.stock }} disponibles
            </span>
          {% else %}
            <span style="background-color: var(--success); color: white; padding: 0.5rem 1rem; border-radius: var(--radius-full); font-weight: 600; font-size: 0.9rem;">
              ‚úì En Stock ({{ producto.stock }})
            </span>
          {% endif %}
        {% else %}
          <span style="background-color: var(--danger); color: white; padding: 0.5rem 1rem; border-radius: var(--radius-full); font-weight: 600; font-size: 0.9rem;">
            ‚úï Agotado
          </span>
        {% endif %}
        <span style="background-color: var(--accent-blue); color: white; padding: 0.5rem 1rem; border-radius: var(--radius-full); font-weight: 600; font-size: 0.9rem;">
          {{ producto.marca }}
        </span>
      </div>
    </div>
    
    <!-- Informaci√≥n -->
    <div>
      <div style="margin-bottom: 1rem;">
        <span style="color: var(--text-secondary); text-transform: uppercase; font-size: 0.85rem; font-weight: 600; letter-spacing: 1px;">
          {{ producto.categoria }}
        </span>
      </div>
      
      <h1 style="font-size: 2.5rem; font-weight: 800; margin-bottom: 1rem; line-height: 1.2; color: var(--text-primary);">
        {{ producto.nombre }}
      </h1>
      
      <div style="display: flex; align-items: baseline; gap: 0.5rem; margin-bottom: 2rem;">
        <span style="font-size: 3rem; font-weight: 800; color: var(--accent-blue);">{{ producto.precio|currency_cop }}</span>
        <span style="font-size: 1.2rem; color: var(--text-secondary);">COP</span>
      </div>
      
      <!-- Descripci√≥n -->
      <div style="background-color: var(--secondary-bg); padding: 1.5rem; border-radius: var(--radius-md); margin-bottom: 2rem;">
        <h3 style="font-size: 1.2rem; font-weight: 700; margin-bottom: 1rem; color: var(--text-primary);">
          üìù Descripci√≥n
        </h3>
        <p style="color: var(--text-secondary); line-height: 1.8; margin: 0;">
          {{ producto.descripcion }}
        </p>
      </div>
      
      <!-- Especificaciones -->
      {% if producto.especificaciones %}
      <div style="background-color: var(--secondary-bg); padding: 1.5rem; border-radius: var(--radius-md); margin-bottom: 2rem;">
        <h3 style="font-size: 1.2rem; font-weight: 700; margin-bottom: 1rem; color: var(--text-primary);">
          ‚öôÔ∏è Especificaciones T√©cnicas
        </h3>
        <div style="color: var(--text-secondary); line-height: 1.8; white-space: pre-wrap; font-family: 'Courier New', monospace; font-size: 0.95rem;">{{ producto.especificaciones }}</div>
      </div>
      {% endif %}
      
      <!-- Botones de acci√≥n -->
      <div style="display: flex; gap: 1rem; margin-bottom: 2rem;">
        {% if producto.stock > 0 %}
          <button 
            onclick="addToCart({{ producto.pk }}, this)" 
            class="btn btn-success btn-lg" 
            style="flex: 1; font-size: 1.2rem; padding: 1.2rem;"
          >
            üõí Agregar al Carrito
          </button>
        {% else %}
          <button 
            class="btn btn-lg" 
            disabled 
            style="flex: 1; background-color: var(--border-color); color: var(--text-secondary); cursor: not-allowed;"
          >
            Producto Agotado
          </button>
        {% endif %}
        
        <a 
          href="{% url 'lista_productos' %}" 
          class="btn btn-outline btn-lg"
          style="padding: 1.2rem 2rem;"
        >
          ‚Üê Volver
        </a>
      </div>
      
      <!-- Informaci√≥n adicional -->
      <div style="background-color: var(--card-bg); padding: 1.5rem; border-radius: var(--radius-md); border: 2px solid var(--accent-blue);">
        <p style="margin: 0; color: var(--text-primary); line-height: 1.8; font-weight: 500;">
          <strong>‚úì Env√≠o gratis</strong> en todos los pedidos<br>
          <strong>‚úì Garant√≠a</strong> de satisfacci√≥n<br>
          <strong>‚úì Soporte t√©cnico</strong> incluido
        </p>
      </div>
      
      <!-- Botones de administraci√≥n -->
      {% if user.is_staff %}
      <div style="margin-top: 2rem; padding-top: 2rem; border-top: 2px solid var(--border-color);">
        <h4 style="color: var(--text-secondary); font-size: 0.9rem; text-transform: uppercase; margin-bottom: 1rem; font-weight: 600;">
          Acciones de Administrador
        </h4>
        <div style="display: flex; gap: 1rem;">
          <a href="{% url 'actualizar_producto' producto.pk %}" class="btn" style="background-color: var(--warning); color: white;">
            ‚úèÔ∏è Editar Producto
          </a>
          <a href="{% url 'eliminar_producto' producto.pk %}" class="btn btn-danger">
            üóëÔ∏è Eliminar Producto
          </a>
        </div>
      </div>
      {% endif %}
    </div>
  </div>
</div>

<!-- Responsive -->
<style>
  @media (max-width: 768px) {
    .container > div:first-of-type {
      grid-template-columns: 1fr !important;
      gap: 2rem !important;
    }
    
    .container > div:first-of-type > div:first-child {
      position: static !important;
    }
    
    h1 {
      font-size: 2rem !important;
    }
  }
</style>

{% endblock %}
